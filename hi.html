<!DOCTYPE html>
<html>
<head>
<title>Page Title</title>
</head>
<body>

<h1>This is a Heading</h1>
<p>This is a paragraph.</p>
<p>hi</p>
</body>
</html>


<!-- app.post('/webhook', (req, res) => {
    const payload = req.body;
    console.log(req.body);
    if (payload&& payload?.action === 'opened' && payload.pull_request) {
      let pullRequest = payload.pull_request;
      res.send(new TextMessage(`Hi there ${res.userProfile.name}. I am ${bot.name}`));
      bot.sendMessage({
        receiver: 'V3WfzB0PnxzAy9Q3f5N7Dw==',
        min_api_version: 2,
        sender: {
          name: 'Goss chat bot'
        },
        type: 'text',
        text: `New pull request in this repository: ${pullRequest.title}`
      });
    }
  });
  // app.post('/viber/webhook', (req, res) => {
  //   const payload = req.body;
  //   if (payload && payload?.action === 'opened' && payload.pull_request) {
  //     let pullRequest = payload.pull_request;
  //     bot.sendMessage({
  //       receiver: 'user_id',
  //       min_api_version: 2,
  //       sender: {
  //         name: 'Your bot name'
  //       },
  //       type: 'text',
  //       text: `New pull request in this repository: ${pullRequest.title}`
  //     });
  //   }
  // });
  //test
  //test2
  
  const port = process.env.PORT || 3000;
  // app.use("/viber/webhook", bot.middleware());
  // app.listen(port, () => {
  //   console.log(`Application running on port: ${port}`);
  //   bot.sendMessage({
  //     receiver: 'V3WfzB0PnxzAy9Q3f5N7Dw==',
  //     min_api_version: 2,
  //     sender: {
  //       name: 'Goss chat bot'
  //     },
  //     type: 'text',
  //     text: 'New pull request in this repository: ${pullRequest.title}'
  //   });
  //   bot.setWebhook(`${process.env.EXPOSE_URL}/viber/webhook`).then(() => {
      
    
  //   }).catch(error => {
  //     console.log('Can not set webhook on following server. Is it running?');
  //     console.error(error);
  //     process.exit(1);
  //   });
  // });
  
  app.use("/viber/webhook", (req, res) => {
    app.listen(port, () => {
         console.log(`Application running on port: ${port}`);});
    if (req.method === 'POST' && req.headers['x-github-event'] === 'pull_request') {
      // handle pull request event
      const pullRequest = req.body;
      // extract the relevant information
      const repository = pullRequest.repository.name;
      const sender = pullRequest.sender.login;
      const action = pullRequest.action;
      const message = `New ${action} request in ${repository} by ${sender}`;
      // notify the user via viber chat
      bot.sendMessage({ id: userId }, { text: message });
      res.status(200).send('pull request event handled');
    } else if (req.method === 'POST' && req.headers['x-github-event'] === 'push') {
      // handle push event
      const pushEvent = req.body;
      // extract the relevant information
      const repository = pushEvent.repository.name;
      const sender = pushEvent.sender.login;
      const message = `New push in ${repository} by ${sender}`;
      // notify the user via viber chat
      bot.sendMessage({ id: userId }, { text: message });
      res.status(200).send('push event handled');
    } else {
      // handle incoming viber messages
      bot.middleware()(req, res);
    }
  });
  
  
  const request = require('request');
  
  const headers = {
    'X-Viber-Auth-Token': '5072e9f1c467e643-f7f0ec35d9acd847-21aab1f7e56301e2'
  };
  
  request.get({
    url: 'https://chatapi.viber.com/pa/get_webhook',
    headers: headers
  }, (error, response, body) => {
    if (error) {
      console.error('Error getting webhook:', error);
    } else {
      console.log(1,JSON.parse(body));
     // console.log(body);
    }
  }); -->
